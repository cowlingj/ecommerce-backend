all: &all
  env: production
  enabled: true
  peerDependenciesHandled: true

elasticsearch:
  enabled: false
  peerDependenciesHandled: true

auth:
  enabled: false
  peerDependenciesHandled: true
  # <<: *all
  fusionauth:
    app:
      version: latest
    search:
      servers: http://elasticsearch-0.elasticsearch.svc.cluster.local:9200
  init:
    image: gcr.io/gke-test-253221/init.auth.admin
    version: 0.0.1

mongodb-config:
  <<: *all
  name: &mongodb-config-name mongodb-config
  group: data
  version: "0.0.1"
  rootPassword: null # generate random password

mongodb:
  image:
    tag: 4.2.0
  service:
    name: mongodb
    port: 8080
  existingSecret: *mongodb-config-name
  fullnameOverride: mongodb
  resources:
    limits: {}
    requests: {}
  persistence:
    size: 128Mi
  podLabels:
    group: data
  configmap: |
    storage:
      dbPath: /bitnami/mongodb/db
      journal:
        enabled: true
      directoryPerDB: true
    systemLog:
      destination: file
    net:
      port: 27017
      unixDomainSocket:
        enabled: false
      ipv6: true
      bindIpAll: true
    #replication:
      #replSetName: {{MONGODB_REPLICA_SET_NAME}}
      #enableMajorityReadConcern: true
    processManagement:
      fork: false
    setParameter:
      enableLocalhostAuthBypass: false
    security:
      authorization: enabled

postgres:
  # <<: *all
  enabled: false
  peerDependenciesHandled: true

cms:
  <<: *all
  name: cms
  group: frontend
  image: "gcr.io/gke-test-253221/cms.admin"
  imagePullSecret: gcr
  version: "0.0.1"
  mongodbHost: null
  mongodbCmsDbName: &cms-db-name cms
  mongodbAdminDbName: &mongodb-admin-database admin
  cookieSecret: null
  ports:
    ui:
      port: 80
      protocol: http
      name: ui
    api:
      port: 8080
      protocol: http
      name: api
  users:
    secretName: cms-users
    existingSecret: false
    list: []
  init:
    mongodb:
      admin:
        secretName: *mongodb-config-name
        mongodbUsername: root # default bitnami mongodb root user
        mongodbDatabase: *mongodb-admin-database
      cms:
        name: &cms-init-cms-name mongodb-cms-config
        existingSecret: false
        secretName: *cms-init-cms-name
        mongodbUsername: cms
        mongodbDatabase: *cms-db-name
        mongodbPassword: null # generate random password
