{{- if not .Values.authAdmin.secrets.clientSecret.exists }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "keystone-cms.scopedName" (list .Values.authAdmin.secrets.clientSecret .) }}
  labels:
{{ include "keystone-cms.labels" . | indent 4 }}
type: Opaque
data:
  client_secret: "{{ .Values.authAdmin.secrets.clientSecret.data.client_secret | b64enc }}"
{{- end }}
---
{{- if not .Values.authAdmin.secrets.encryptionKey.exists }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "keystone-cms.scopedName" (list .Values.authAdmin.secrets.encryptionKey .) }}
  labels:
{{ include "keystone-cms.labels" . | indent 4 }}
type: Opaque
data:
  encryption_key: "{{ (print .Values.authAdmin.secrets.encryptionKey.data.encryption_key (randAscii 32)) | trunc 32 | b64enc }}"
{{- end }}
---
{{- if not .Values.authApi.secrets.clientSecret.exists }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "keystone-cms.scopedName" (list .Values.authApi.secrets.clientSecret .) }}
  labels:
{{ include "keystone-cms.labels" . | indent 4 }}
type: Opaque
data:
  client_secret: "{{ .Values.authApi.secrets.clientSecret.data.client_secret | b64enc }}"
{{- end }}
---
{{- if not .Values.authApi.secrets.encryptionKey.exists }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "keystone-cms.scopedName" (list .Values.authApi.secrets.encryptionKey .) }}
  labels:
{{ include "keystone-cms.labels" . | indent 4 }}
type: Opaque
data: 
  encryption_key: "{{ (print .Values.authApi.secrets.encryptionKey.data.encryption_key (randAscii 32)) | trunc 32 | b64enc }}"
{{- end }}
