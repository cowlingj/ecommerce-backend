name: Rebase Develop
on:
  push:
    branches:
      - master

jobs:
  rebase:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          ref: develop
      - run: |-
          git config user.email '09cowlingj+bot@gmail.com'
          git config user.name 'Bot'
          git config user.password ${{ secrets.GH_BOT_TOKEN }}
          echo "::set-env name=GIT_USER::cowlingj-bot:${{ secrets.GH_BOT_TOKEN }}"
          git remote add origin "https://${{ env.GIT_USER }}:${{ secrets.GH_BOT_TOKEN }}@github.com/${{ github.repository }}.git"
      - uses: nick-invision/retry@v1
        with:
          timeout_minutes: 5
          max_attempts: 3
          command: |-
            git rebase origin/master
            git push